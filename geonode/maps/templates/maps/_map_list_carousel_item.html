{% load url from future %}
{% load i18n %}
{% load agon_ratings_tags %}
{% load base_tags %}

{% overall_rating map "map" as map_rating %} {% num_ratings map as num_votes %}
<article style="border-style: none !important;" class="featured-map-carousel">
  <div class="row carousel-map">
	<div class="span4 carousel-thumb-background" style="background-image:url('{{ map.get_thumbnail_url }}');">
	</div>
	  <div class="featured-map-formatting">
		<h3><i class="icon-map-marker"></i> <a href="{% url "map_detail" map.id %}">{{ map.title }}</a></h3>
		<div class="details">
		  <div class="meta">
			<p>Map {% trans "from" %} <a href="{% url "profile_detail" map.owner.username %}" rel="author">{{ map.owner }}</a>, {{ map.last_modified|timesince }} {% trans 'ago' %}</p>
			<p class="abstract">{{ map.abstract|slice:":110" }}{% if map.abstract|length > 110 %}...{% endif %}</p>
			<ul class="nav stats">
			  <li><a href="{% url "map_detail" map.id %}"><strong>{{ map.popular_count }}</strong> {% trans "view" %}{{ map.popular_count|pluralize }}</a></li>
			  <li><a href="{% url "map_detail" map.id %}#rate"><strong><span class="avg_rating" data-rating="{{ map_rating }}"> <span class="overall_rating"></span></span></strong>{% trans "Average rating" %} ({{num_votes}} {% trans "votes" %})</a></li>
			</ul>
		  </div>
		  <p>
			<a href="{% url "map_download" map.id %}" class="btn btn-mini">{% trans "Download" %}</a>
			<a href="{% url "map_view" map.id %}" class="btn btn-mini">{% trans "View" %}</a>
		  </p>
		</div> 
  </div>
</article>
